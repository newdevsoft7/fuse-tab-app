<div id="users-search-bar-wrapper" fxLayout="row" fxLayoutAlign="start center">

    <button mat-icon-button (click)="openFiltersDialog()">
        <mat-icon class="mat-icon material-icons" role="img" aria-hidden="true">search</mat-icon>
    </button>
    
    <div fxFlex="100">
        <mat-form-field fxFlexFill>
            <mat-chip-list #chipList>
                <mat-chip *ngFor="let item of value" (remove)="remove(item)">
                    {{item.text}} <mat-icon matChipRemove>cancel</mat-icon>
                </mat-chip>

                <input #chipInput 
                    [matChipInputFor]="chipList" 
                    [matChipInputAddOnBlur]="false" 
                    (matChipInputTokenEnd)="addNew($event)" 
                    [matAutocomplete]="auto" />
            </mat-chip-list>
        </mat-form-field>

        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" (optionSelected)="add($event)">
            <ng-container *ngFor="let group of source">
                <mat-optgroup *ngIf=" sourceFiltered(group.children).length>0" [label]="group.text">
                    <mat-option *ngFor="let option of sourceFiltered(group.children)" [value]="option">
                        {{option.text}}
                    </mat-option>
                </mat-optgroup>
            </ng-container>
        </mat-autocomplete>
    </div>

</div>